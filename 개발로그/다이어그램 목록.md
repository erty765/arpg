**## PopupActor íë¦„ë„**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart TD

&nbsp;   A\["ANAItemActor"] -- Before<br>Destroyed --> B\["Detach<br>ItemWidgetComponent"]

&nbsp;   B --> C\["Spawn<br>ANAItemWidgetPopupActor"]

&nbsp;   C --> D\["Attach \&amp; Register<br>Widget"]

&nbsp;   D --> E\["Play<br>Collapse Animation"]

&nbsp;   E --> F\["OnCollapseAnimationFinished<br>-\&gt; Destroy"]





**## DataTable ë¡œë”© ë° UNAItemData ë§¤í•‘ íë¦„ë„**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart LR

&nbsp;   A{"Engine<br>Initialization"} ==> B\["UNAItemEngineSubsystem::Initialize"]

&nbsp;   B --> C\["Load UItemDataTablesAsset"]

&nbsp;   C --> D\["Iterate ItemDataTables"]

&nbsp;   D --> E\["Load DataTable"]

&nbsp;   E --> F\["Map SoftItemMetaData with ItemClass as Key"]

&nbsp;   F --> G\["Iterate SoftItemMetaData and Synchronously Load ItemClass"]

&nbsp;   G --> H\["Build ItemMetaDataMap with ItemClass as Key"]

&nbsp;   H --> I\["Blueprint CDO Dynamic Initialization \& Compile"]

&nbsp;   I ==> J{"Item Metadata Initialization Complete"}

&nbsp;   



**## ì•„ì´í…œ ì‹œìŠ¤í…œ ì•¡í„° í´ë˜ìŠ¤ ìƒì† êµ¬ì¡°**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

&nbsp;   class ANAItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANAPickableItemActor

&nbsp;   class ANAMedPack

&nbsp;   class ANAUpgradeNode

&nbsp;   class ANAPlaceableItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANADoor

&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- ANAMedPack

&nbsp;   ANAPickableItemActor <|-- ANAUpgradeNode

&nbsp;   ANAPlaceableItemActor <|-- ANADoor





**## ëŸ°íƒ€ì„ ì¤‘ ì•„ì´í…œ ì•¡í„° ìƒì„± íë¦„**

---

config:

Â  layout: elk

Â  theme: base

---

flowchart TD

&nbsp;   A\[ì•„ì´í…œ ìŠ¤í° ì‹œ] --> B\[ANAItemActor OnConstruction]

&nbsp;   B --> C\[InitItemData í˜¸ì¶œ]

&nbsp;   C --> D\[UNAItemEngineSubsystem CreateItemDataByActor]

&nbsp;   D --> E\[ItemMetaDataMap í†µí•´ ë©”íƒ€ë°ì´í„° ì—°ë™]

&nbsp;   E --> F\[ItemDataID í• ë‹¹]

&nbsp;   F --> G\[ì•¡í„° ì´ˆê¸°í™” ì™„ë£Œ]





**## ëŸ°íƒ€ì„ ì¤‘ ì•„ì´í…œ ì‚¬ìš© íë¦„**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart TD

&nbsp;   A\["ì•„ì´í…œ ì‚¬ìš© ì‹œ"] --> B\["UNAItemData TryUseItem"]

&nbsp;   B --> C\["ItemClass Get GetDefaultObject"]

&nbsp;   C --> D\["CDOì—ì„œ INAItemUseInterface UseItem í˜¸ì¶œ"]





**## ì•„ì´í…œ ì•¡í„° íƒ€ì… êµ¬ì¡° -Pickable / Placeable**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

direction TB

&nbsp;   class NAWeapon {

&nbsp;	    +CombatComponent: UNAMontageCombatComponent

&nbsp;	    +AbilitySystemComponent: UAbilitySystemComponent

&nbsp;	    +MuzzleFlashComponent: UNiagaraComponent

&nbsp;	    +AmmoIndicatorComponent: UNAAmmoIndicatorComponent

&nbsp;	    +FireArmType: EFireArmType

&nbsp;	    +GetFireArmType()

&nbsp;   }

&nbsp;   class NAMedpack {

&nbsp;	    +MedPackGrade: EMedPackGrade

&nbsp;	    +CanUseItem()

&nbsp;	    +UseItem()

&nbsp;   }

&nbsp;   class NADoor {

&nbsp;	    +Door1: UStaticMeshComponent

&nbsp;	    +Door2: UStaticMeshComponent

&nbsp;	    +DoorType: EDoorType

&nbsp;	    +MoveDist: double

&nbsp;	    +ToggleDoor()

&nbsp;   }

&nbsp;   class ANAPlaceableItemActor {

&nbsp;	    +InteractableType

&nbsp;	    +Implements ExecuteInteract()

&nbsp;   }

&nbsp;	class ANAPickableItemActor {

&nbsp;	    +PickupMode: EPickupMode

&nbsp;	    +TryPerformAutoUse()

&nbsp;   }

&nbsp;   class ANAItemActor {

&nbsp;	    +ItemCollision: UShapeComponent

&nbsp;	    +ItemMesh: UMeshComponent

&nbsp;	    +TriggerSphere: USphereComponent

&nbsp;	    +ItemWidgetComponent: UNAItemWidgetComponent

&nbsp;	    +GetItemData()

&nbsp;	    +CanInteract()

&nbsp;	    +TryInteract()

&nbsp;	    +NotifyFocusBegin/End()

&nbsp;   }



&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- NAWeapon

&nbsp;   ANAPickableItemActor <|-- NAMedpack

&nbsp;   ANAPlaceableItemActor <|-- NADoor



&nbsp;   <<Abstract>> ANAPickableItemActor

&nbsp;   <<Abstract>> ANAPlaceableItemActor

&nbsp;   <<Abstract>> ANAItemActor



&nbsp;   note for ANAItemActor "ì›”ë“œ ì•„ì´í…œ ê¸°ë³¸,<br>ì‹œê°/ì¶©ëŒ/ìƒí˜¸ì‘ìš© ì œê³µ"

&nbsp;   note for ANAPickableItemActor "íšë“ ê°€ëŠ¥ ì•„ì´í…œ<br>(ì¸ë²¤í† ë¦¬/ìë™ì‚¬ìš©/ë“¤ê¸°) ë‹´ë‹¹"

&nbsp;   note for ANAPlaceableItemActor "ë°°ì¹˜ ê°€ëŠ¥ ì•„ì´í…œ<br>(í™˜ê²½ ìƒí˜¸ì‘ìš©) ë‹´ë‹¹"





**## ì•„ì´í…œ ì•¡í„°ì™€ ì•„ì´í…œ ë°ì´í„°ì˜ ê´€ê³„**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart LR

&nbsp;   A\["ANAItemActor<br>Visual Representation + Interaction"] -- Refers by ItemDataID(FName) --> B\["UNAItemData<br>Quantity, State, Metadata Reference + Use Logic"]

&nbsp;   B -. Accesses Item Actor CDO<br>via metadata .-> A





**## CreateItemDataByActor**

---

config:

Â  theme: base

---

flowchart TD

Â    A\[Actor Spawned] --> B\[Check ItemDataID]

Â    B --> C\[Lookup Metadata]

Â    C --> D\[Create UNAItemData]

Â    D --> E\[Configure Subobjects Dynamically]





**## ë°ì´í„° ì¤‘ì‹¬ì˜ ì´ˆê¸°í™” íë¦„**

---

config:

&nbsp; theme: base

&nbsp; look: neo

&nbsp; layout: elk

---

flowchart LR

&nbsp;   Start\["Engine Init"] --> Load\["Load<br>DataTables Asset"]

&nbsp;   Load --> Map\["Map:<br>ItemClass â†’ RowHandle"]

&nbsp;   Map --> Init\["Initialize Item CDO"]





**## í´ë˜ìŠ¤ â†” ë°ì´í„° í–‰ ìë™ ë§¤í•‘ êµ¬ì¡°**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart TD

&nbsp;   A\["DataTable (FNAItemBaseTableRow)"] --> B\["Item RowHandle (RowName)"]

&nbsp;   B --> C\["SoftClassPtr(ANAItemActor)"]

&nbsp;   C --> D\["ANAItemActor CDO"]

&nbsp;   D --> E\["Dynamic Init by Metadata"]





**## Interaction Flow with Custom Point**

---

config:

Â  theme: base

Â  layout: fixed

---

flowchart TD

Â    A\["Player overlaps item trigger"] --> B\["NotifyInteractableFocusBegin()"]

Â    B --> C\["Register in FocusedInteractables<br>+ Enable Tick"]

Â    C --> D\["Player presses interaction key"]

Â    D --> F\["Call StratInteraction()"]

Â    F --> G\["PickupMode<br>ğŸ”§Designer-controlled"] \& J\["InteractableType<br>ğŸ”§Designer-controlled"]

Â    G -- AutoUse --> H1\["TryPerformAutoUse()"]

Â    G -- Inventory --> H2\["TryAddItemToInventory()"]

Â    G -- CarryOnly --> H3\["TryAttachItemMeshToOwner()"]

Â    H1 --> I1{"Item fully consumed?"}

Â    I1 -- Yes --> Z1\["Destroy Item Actor"]

Â    I1 -- No --> Z2\["Update Item Quantity"]

Â    H2 --> I2{"Inventory full?"}

Â    I2 -- Yes --> Z3\["Interaction failed"]

Â    I2 -- No --> Z4\["Add to inventory<br>â†’ Destroy or keep"]

Â    H3 --> I3{"Hand empty?"}

Â    I3 -- Yes --> Z5\["Attach item to hand<br>- ChildActor"]

Â    I3 -- No --> Z6\["Use item<br>or Drop item"]

Â    J -- Inspect --> K1\["Show inspect UI"]

Â    J -- Install --> K2\["Start placement mode"]

Â    J -- Toggle --> K3\["Toggle actor state"]

Â    Z1 --> END(\["Finalize interaction"])

Â    Z2 --> END

Â    Z3 --> END

Â    Z4 --> END

Â    Z5 --> END

Â    Z6 --> END

Â    K1 --> END

Â    K2 --> END

Â    K3 --> END

Â    G@{ shape: rounded}

Â    J@{ shape: rounded}

Â     G:::Aqua

Â     J:::Aqua

Â    classDef Aqua stroke-width:1px, stroke-dasharray:none, stroke:#46EDC8, fill:#DEFFF8, color:#378E7A





**## ì•„ì´í…œ ì•¡í„° ìƒì„± ìš”ì²­ì˜ ì‹œì‘ì **

---

config:

&nbsp; layout: fixed

&nbsp; theme: base

---

flowchart TD

&nbsp;subgraph subGraph0\["Main Request Origin Points"]

&nbsp;       A\["Player Item Acquisition"]

&nbsp;       C\["Monster Item Drop"]

&nbsp;       E\["Shop Item Purchase"]

&nbsp; end

&nbsp;subgraph subGraph1\["Intermediate Request Processing"]

&nbsp;       B("Inventory Component")

&nbsp;       D("Monster Drop Logic")

&nbsp;       F("Shop System")

&nbsp; end

&nbsp;subgraph subGraph2\["Central Management System"]

&nbsp;       G("UNAItemEngineSubsystem")

&nbsp; end

&nbsp;   A --> B

&nbsp;   C --> D

&nbsp;   E --> F

&nbsp;   B --> G

&nbsp;   D --> G

&nbsp;   F --> G

&nbsp;   G --> H\["Item Actor Creation and Initialization"]

&nbsp;    G:::Aqua

&nbsp;   classDef Aqua stroke-width:1px, stroke-dasharray:none, stroke:#46EDC8, fill:#DEFFF8, color:#378E7A





**## ì•„ì´í…œ ìŠ¤í° ë° ë°ì´í„° ì£¼ì… íë¦„**

---

config:

&nbsp; theme: base

&nbsp; layout: dagre

---

flowchart LR

&nbsp;subgraph UNAItemEngineSubsystem\["UNAItemEngineSubsystem"]

&nbsp;       B\["FNAItemBaseTableRow"]

&nbsp;       A\["DataTable Load"]

&nbsp;       C\["TSoftClassPtr ItemClass"]

&nbsp;       D\["CreateItemDataByActor()"]

&nbsp; end

&nbsp;subgraph subGraph1\["Item Actor Creation"]

&nbsp;       E\["Spawn<br>ANAItemActor Blueprint Class"]

&nbsp;       F\["Inject<br>UNAItemData Instance"]

&nbsp; end

&nbsp;subgraph Result\["Result"]

&nbsp;       G\["Fully Initialized<br>ANAItemActor"]

&nbsp; end

&nbsp;   A --> B

&nbsp;   B --> C

&nbsp;   C -- ì¶”ì¶œëœ<br>ItemClass --> D

&nbsp;   D -- ItemData<br>ìƒì„± ìš”ì²­ --> E

&nbsp;   E -- ìŠ¤í°ëœ<br>ItemActor --> F

&nbsp;   F --> G







