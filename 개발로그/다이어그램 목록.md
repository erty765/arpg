**## PopupActor 흐름도**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart TD

&nbsp;   A\["ANAItemActor"] -- Before<br>Destroyed --> B\["Detach<br>ItemWidgetComponent"]

&nbsp;   B --> C\["Spawn<br>ANAItemWidgetPopupActor"]

&nbsp;   C --> D\["Attach \&amp; Register<br>Widget"]

&nbsp;   D --> E\["Play<br>Collapse Animation"]

&nbsp;   E --> F\["OnCollapseAnimationFinished<br>-\&gt; Destroy"]





**## DataTable 로딩 및 UNAItemData 매핑 흐름도**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart LR

&nbsp;   A{"Engine<br>Initialization"} ==> B\["UNAItemEngineSubsystem::Initialize"]

&nbsp;   B --> C\["Load UItemDataTablesAsset"]

&nbsp;   C --> D\["Iterate ItemDataTables"]

&nbsp;   D --> E\["Load DataTable"]

&nbsp;   E --> F\["Map SoftItemMetaData with ItemClass as Key"]

&nbsp;   F --> G\["Iterate SoftItemMetaData and Synchronously Load ItemClass"]

&nbsp;   G --> H\["Build ItemMetaDataMap with ItemClass as Key"]

&nbsp;   H --> I\["Blueprint CDO Dynamic Initialization \& Compile"]

&nbsp;   I ==> J{"Item Metadata Initialization Complete"}

&nbsp;   



**## 아이템 시스템 액터 클래스 상속 구조**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

&nbsp;   class ANAItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANAPickableItemActor

&nbsp;   class ANAMedPack

&nbsp;   class ANAUpgradeNode

&nbsp;   class ANAPlaceableItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANADoor

&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- ANAMedPack

&nbsp;   ANAPickableItemActor <|-- ANAUpgradeNode

&nbsp;   ANAPlaceableItemActor <|-- ANADoor





**## 런타임 중 아이템 액터 생성 흐름**

---

config:

  layout: elk

  theme: base

---

flowchart TD

&nbsp;   A\[아이템 스폰 시] --> B\[ANAItemActor OnConstruction]

&nbsp;   B --> C\[InitItemData 호출]

&nbsp;   C --> D\[UNAItemEngineSubsystem CreateItemDataByActor]

&nbsp;   D --> E\[ItemMetaDataMap 통해 메타데이터 연동]

&nbsp;   E --> F\[ItemDataID 할당]

&nbsp;   F --> G\[액터 초기화 완료]





**## 런타임 중 아이템 사용 흐름**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart TD

&nbsp;   A\["아이템 사용 시"] --> B\["UNAItemData TryUseItem"]

&nbsp;   B --> C\["ItemClass Get GetDefaultObject"]

&nbsp;   C --> D\["CDO에서 INAItemUseInterface UseItem 호출"]





**## 아이템 액터 타입 구조 -Pickable / Placeable**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

&nbsp;   class ANAItemActor {

&nbsp;       <<Abstract>>

&nbsp;       +UShapeComponent\* ItemCollision

&nbsp;       +UMeshComponent\* ItemMesh

&nbsp;       +USphereComponent\* TriggerSphere

&nbsp;       +UNAItemWidgetComponent\* ItemWidgetComponent

&nbsp;       +UNAItemData\* GetItemData()

&nbsp;       +bool HasValidItemID()

&nbsp;       +bool CanInteract()

&nbsp;       +bool IsOnInteract()

&nbsp;       +void NotifyInteractableFocusBegin()

&nbsp;       +void NotifyInteractableFocusEnd()

&nbsp;       +bool TryInteract()

&nbsp;       +bool BeginInteract()

&nbsp;       +bool ExecuteInteract()

&nbsp;       +bool EndInteract()

&nbsp;   }

&nbsp;   class ANAPickableItemActor {

&nbsp;       +EPickupMode PickupMode

&nbsp;       +int32 TryPerformAutoUse()

&nbsp;       +int32 PerformAutoUse\_Impl()

&nbsp;   }

&nbsp;   class ANAPlaceableItemActor {

&nbsp;       -- No specific members shown in .h but focus on environmental interaction --

&nbsp;   }

&nbsp;   class NAWeapon {

&nbsp;       +UNAMontageCombatComponent\* CombatComponent

&nbsp;       +UAbilitySystemComponent\* AbilitySystemComponent

&nbsp;       +UNiagaraComponent\* MuzzleFlashComponent

&nbsp;       +UNAAmmoIndicatorComponent\* AmmoIndicatorComponent

&nbsp;       +EFireArmType FireArmType

&nbsp;       +EFireArmType GetFireArmType()

&nbsp;       +UAbilitySystemComponent\* GetAbilitySystemComponent()

&nbsp;   }

&nbsp;   class NAMedpack {

&nbsp;       +EMedPackGrade MedPackGrade

&nbsp;       +bool CanUseItem()

&nbsp;       +bool UseItem()

&nbsp;       +EMedPackGrade GetMedPackGrade()

&nbsp;   }

&nbsp;   class NADoor {

&nbsp;       +UStaticMeshComponent\* Door1

&nbsp;       +UStaticMeshComponent\* Door2

&nbsp;       +EDoorType DoorType

&nbsp;       +double MoveDist

&nbsp;       +bool bIsLocked

&nbsp;       +bool bIsOpened

&nbsp;       +void ToggleDoor()

&nbsp;   }

&nbsp;   class NAButtonSwitch {

&nbsp;       +ANAPlaceableItemActor\* TargetToActive

&nbsp;       +bool bIsActive

&nbsp;   }

&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- NAWeapon

&nbsp;   ANAPickableItemActor <|-- NAMedpack

&nbsp;   ANAPlaceableItemActor <|-- NADoor

&nbsp;   ANAPlaceableItemActor <|-- NAButtonSwitch

&nbsp;   ANAPickableItemActor : Responsible for inventory acquisition and management.

&nbsp;   ANAPlaceableItemActor : Responsible for world placement and environmental interaction.

&nbsp;   ANAItemActor : Provides common visual, physics, and interaction components.





**## 아이템 액터와 아이템 데이터의 관계**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart LR

&nbsp;   A\["ANAItemActor<br>Visual Representation + Interaction"] -- Refers by ItemDataID(FName) --> B\["UNAItemData<br>Quantity, State, Metadata Reference + Use Logic"]

&nbsp;   B -. Accesses Item Actor CDO<br>via metadata .-> A





**## CreateItemDataByActor**

---

config:

  theme: base

---

flowchart TD

    A\[Actor Spawned] --> B\[Check ItemDataID]

    B --> C\[Lookup Metadata]

    C --> D\[Create UNAItemData]

    D --> E\[Configure Subobjects Dynamically]





