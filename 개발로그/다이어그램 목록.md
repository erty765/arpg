**## PopupActor 흐름도**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart TD

&nbsp;   A\["ANAItemActor"] -- Before<br>Destroyed --> B\["Detach<br>ItemWidgetComponent"]

&nbsp;   B --> C\["Spawn<br>ANAItemWidgetPopupActor"]

&nbsp;   C --> D\["Attach \&amp; Register<br>Widget"]

&nbsp;   D --> E\["Play<br>Collapse Animation"]

&nbsp;   E --> F\["OnCollapseAnimationFinished<br>-\&gt; Destroy"]





**## DataTable 로딩 및 UNAItemData 매핑 흐름도**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart LR

&nbsp;   A{"Engine<br>Initialization"} ==> B\["UNAItemEngineSubsystem::Initialize"]

&nbsp;   B --> C\["Load UItemDataTablesAsset"]

&nbsp;   C --> D\["Iterate ItemDataTables"]

&nbsp;   D --> E\["Load DataTable"]

&nbsp;   E --> F\["Map SoftItemMetaData with ItemClass as Key"]

&nbsp;   F --> G\["Iterate SoftItemMetaData and Synchronously Load ItemClass"]

&nbsp;   G --> H\["Build ItemMetaDataMap with ItemClass as Key"]

&nbsp;   H --> I\["Blueprint CDO Dynamic Initialization \& Compile"]

&nbsp;   I ==> J{"Item Metadata Initialization Complete"}

&nbsp;   



**## 아이템 시스템 액터 클래스 상속 구조**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

&nbsp;   class ANAItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANAPickableItemActor

&nbsp;   class ANAMedPack

&nbsp;   class ANAUpgradeNode

&nbsp;   class ANAPlaceableItemActor {

&nbsp;       <<abstract>>

&nbsp;   }

&nbsp;   class ANADoor

&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- ANAMedPack

&nbsp;   ANAPickableItemActor <|-- ANAUpgradeNode

&nbsp;   ANAPlaceableItemActor <|-- ANADoor





**## 런타임 중 아이템 액터 생성 흐름**

---

config:

  layout: elk

  theme: base

---

flowchart TD

&nbsp;   A\[아이템 스폰 시] --> B\[ANAItemActor OnConstruction]

&nbsp;   B --> C\[InitItemData 호출]

&nbsp;   C --> D\[UNAItemEngineSubsystem CreateItemDataByActor]

&nbsp;   D --> E\[ItemMetaDataMap 통해 메타데이터 연동]

&nbsp;   E --> F\[ItemDataID 할당]

&nbsp;   F --> G\[액터 초기화 완료]





**## 런타임 중 아이템 사용 흐름**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart TD

&nbsp;   A\["아이템 사용 시"] --> B\["UNAItemData TryUseItem"]

&nbsp;   B --> C\["ItemClass Get GetDefaultObject"]

&nbsp;   C --> D\["CDO에서 INAItemUseInterface UseItem 호출"]





**## 아이템 액터 타입 구조 -Pickable / Placeable**

---

config:

&nbsp; theme: base

&nbsp; layout: elk

---

classDiagram

direction TB

&nbsp;   class NAWeapon {

&nbsp;	    +CombatComponent: UNAMontageCombatComponent

&nbsp;	    +AbilitySystemComponent: UAbilitySystemComponent

&nbsp;	    +MuzzleFlashComponent: UNiagaraComponent

&nbsp;	    +AmmoIndicatorComponent: UNAAmmoIndicatorComponent

&nbsp;	    +FireArmType: EFireArmType

&nbsp;	    +GetFireArmType()

&nbsp;   }

&nbsp;   class NAMedpack {

&nbsp;	    +MedPackGrade: EMedPackGrade

&nbsp;	    +CanUseItem()

&nbsp;	    +UseItem()

&nbsp;   }

&nbsp;   class NADoor {

&nbsp;	    +Door1: UStaticMeshComponent

&nbsp;	    +Door2: UStaticMeshComponent

&nbsp;	    +DoorType: EDoorType

&nbsp;	    +MoveDist: double

&nbsp;	    +ToggleDoor()

&nbsp;   }

&nbsp;   class ANAPlaceableItemActor {

&nbsp;	    +InteractableType

&nbsp;	    +Implements ExecuteInteract()

&nbsp;   }

&nbsp;	class ANAPickableItemActor {

&nbsp;	    +PickupMode: EPickupMode

&nbsp;	    +TryPerformAutoUse()

&nbsp;   }

&nbsp;   class ANAItemActor {

&nbsp;	    +ItemCollision: UShapeComponent

&nbsp;	    +ItemMesh: UMeshComponent

&nbsp;	    +TriggerSphere: USphereComponent

&nbsp;	    +ItemWidgetComponent: UNAItemWidgetComponent

&nbsp;	    +GetItemData()

&nbsp;	    +CanInteract()

&nbsp;	    +TryInteract()

&nbsp;	    +NotifyFocusBegin/End()

&nbsp;   }



&nbsp;   ANAItemActor <|-- ANAPickableItemActor

&nbsp;   ANAItemActor <|-- ANAPlaceableItemActor

&nbsp;   ANAPickableItemActor <|-- NAWeapon

&nbsp;   ANAPickableItemActor <|-- NAMedpack

&nbsp;   ANAPlaceableItemActor <|-- NADoor



&nbsp;   <<Abstract>> ANAPickableItemActor

&nbsp;   <<Abstract>> ANAPlaceableItemActor

&nbsp;   <<Abstract>> ANAItemActor



&nbsp;   note for ANAItemActor "월드 아이템 기본,<br>시각/충돌/상호작용 제공"

&nbsp;   note for ANAPickableItemActor "획득 가능 아이템<br>(인벤토리/자동사용/들기) 담당"

&nbsp;   note for ANAPlaceableItemActor "배치 가능 아이템<br>(환경 상호작용) 담당"





**## 아이템 액터와 아이템 데이터의 관계**

---

config:

&nbsp; layout: elk

&nbsp; theme: base

---

flowchart LR

&nbsp;   A\["ANAItemActor<br>Visual Representation + Interaction"] -- Refers by ItemDataID(FName) --> B\["UNAItemData<br>Quantity, State, Metadata Reference + Use Logic"]

&nbsp;   B -. Accesses Item Actor CDO<br>via metadata .-> A





**## CreateItemDataByActor**

---

config:

  theme: base

---

flowchart TD

    A\[Actor Spawned] --> B\[Check ItemDataID]

    B --> C\[Lookup Metadata]

    C --> D\[Create UNAItemData]

    D --> E\[Configure Subobjects Dynamically]





**## 데이터 중심의 초기화 흐름**

---

config:

&nbsp; theme: base

&nbsp; look: neo

&nbsp; layout: elk

---

flowchart LR

&nbsp;   Start\["Engine Init"] --> Load\["Load<br>DataTables Asset"]

&nbsp;   Load --> Map\["Map:<br>ItemClass → RowHandle"]

&nbsp;   Map --> Init\["Initialize Item CDO"]





**## 클래스 ↔ 데이터 행 자동 매핑 구조**

---

config:

&nbsp; theme: base

&nbsp; layout: fixed

---

flowchart TD

&nbsp;   A\["DataTable (FNAItemBaseTableRow)"] --> B\["Item RowHandle (RowName)"]

&nbsp;   B --> C\["SoftClassPtr(ANAItemActor)"]

&nbsp;   C --> D\["ANAItemActor CDO"]

&nbsp;   D --> E\["Dynamic Init by Metadata"]





**## Interaction Flow with Custom Point**

---

config:

  theme: base

  layout: fixed

---

flowchart TD

    A\["Player overlaps item trigger"] --> B\["NotifyInteractableFocusBegin()"]

    B --> C\["Register in FocusedInteractables<br>+ Enable Tick"]

    C --> D\["Player presses interaction key"]

    D --> F\["Call StratInteraction()"]

    F --> G\["PickupMode<br>🔧Designer-controlled"] \& J\["InteractableType<br>🔧Designer-controlled"]

    G -- AutoUse --> H1\["TryPerformAutoUse()"]

    G -- Inventory --> H2\["TryAddItemToInventory()"]

    G -- CarryOnly --> H3\["TryAttachItemMeshToOwner()"]

    H1 --> I1{"Item fully consumed?"}

    I1 -- Yes --> Z1\["Destroy Item Actor"]

    I1 -- No --> Z2\["Update Item Quantity"]

    H2 --> I2{"Inventory full?"}

    I2 -- Yes --> Z3\["Interaction failed"]

    I2 -- No --> Z4\["Add to inventory<br>→ Destroy or keep"]

    H3 --> I3{"Hand empty?"}

    I3 -- Yes --> Z5\["Attach item to hand<br>- ChildActor"]

    I3 -- No --> Z6\["Use item<br>or Drop item"]

    J -- Inspect --> K1\["Show inspect UI"]

    J -- Install --> K2\["Start placement mode"]

    J -- Toggle --> K3\["Toggle actor state"]

    Z1 --> END(\["Finalize interaction"])

    Z2 --> END

    Z3 --> END

    Z4 --> END

    Z5 --> END

    Z6 --> END

    K1 --> END

    K2 --> END

    K3 --> END

    G@{ shape: rounded}

    J@{ shape: rounded}

     G:::Aqua

     J:::Aqua

    classDef Aqua stroke-width:1px, stroke-dasharray:none, stroke:#46EDC8, fill:#DEFFF8, color:#378E7A





**## 아이템 액터 생성 요청의 시작점**

---

config:

&nbsp; layout: fixed

&nbsp; theme: base

---

flowchart TD

&nbsp;subgraph subGraph0\["Main Request Origin Points"]

&nbsp;       A\["Player Item Acquisition"]

&nbsp;       C\["Monster Item Drop"]

&nbsp;       E\["Shop Item Purchase"]

&nbsp; end

&nbsp;subgraph subGraph1\["Intermediate Request Processing"]

&nbsp;       B("Inventory Component")

&nbsp;       D("Monster Drop Logic")

&nbsp;       F("Shop System")

&nbsp; end

&nbsp;subgraph subGraph2\["Central Management System"]

&nbsp;       G("UNAItemEngineSubsystem")

&nbsp; end

&nbsp;   A --> B

&nbsp;   C --> D

&nbsp;   E --> F

&nbsp;   B --> G

&nbsp;   D --> G

&nbsp;   F --> G

&nbsp;   G --> H\["Item Actor Creation and Initialization"]

&nbsp;    G:::Aqua

&nbsp;   classDef Aqua stroke-width:1px, stroke-dasharray:none, stroke:#46EDC8, fill:#DEFFF8, color:#378E7A





**## 아이템 스폰 및 데이터 주입 흐름**

---

config:

&nbsp; theme: base

&nbsp; layout: dagre

---

flowchart LR

&nbsp;subgraph UNAItemEngineSubsystem\["UNAItemEngineSubsystem"]

&nbsp;       B\["FNAItemBaseTableRow"]

&nbsp;       A\["DataTable Load"]

&nbsp;       C\["TSoftClassPtr ItemClass"]

&nbsp;       D\["CreateItemDataByActor()"]

&nbsp; end

&nbsp;subgraph subGraph1\["Item Actor Creation"]

&nbsp;       E\["Spawn<br>ANAItemActor Blueprint Class"]

&nbsp;       F\["Inject<br>UNAItemData Instance"]

&nbsp; end

&nbsp;subgraph Result\["Result"]

&nbsp;       G\["Fully Initialized<br>ANAItemActor"]

&nbsp; end

&nbsp;   A --> B

&nbsp;   B --> C

&nbsp;   C -- 추출된<br>ItemClass --> D

&nbsp;   D -- ItemData<br>생성 요청 --> E

&nbsp;   E -- 스폰된<br>ItemActor --> F

&nbsp;   F --> G







